National GWP Project

We have limited understanding of how crop type and practice influence GHG emissions across large scales. This project deploys three biogeochemical crop models that take into account crop type and management toward GHG emissions from soil processes across the United States in each different county (3,108 total) taking into account different climate, soil, and geographic location of each county.

Crop types are: 
1. Maize
2. Soybean
3. Winter Wheat
4. Cotton
5. Crop Rotation (Maize and Soybean).

Crop managmenet scenarios are:
1. Monoculture - no change
2. No-till 
3. Cover crop mix (Cereal/Legume/Brassica)
4. Cover crop cereal only
5. Cover crop legume only
6. Cover crop mix (Cereal/Legume/Brassica) and no-till

Climate scenarios are:
1. Low radiative forcing
2. High radiative forcing


A modeling codebase was modified by a previous project that looked at similar crop dynamics and GHG emissions, but only for a few experimental locations. This project scaled up to 3,108 county locations across CONUS. All modeling was completed using R in Rstudio. The model was created in a linux environment. For development, Linux Mint 20.1 was used, and then the model was deployed within the UCAR Derecho linux supercomputer.

The previous project was forked from https://github.com/edvlmaas/national_gwp to https://github.com/adampdixon/national_gwp.

The model script names indicate the sequence of the model. Since the model was adapted from the previous project looking at two experimental sites, the sequence of files is really a remnant of that process. Most model files were kept because separating pieces of the model sequence in the same way made sense. There are times though that an argument could have been made to consolidate model scripts a bit more. If model integrity was not comprimised the approach taken was to change as little as possible. Also to note is that there may be remnants of the old project methodology embedded in the code logic and in the comments. An attempt was made to remove comments and only use comments applicable to this project, but there likely remains remnants.


Data input pre-processing

Climate is described by:

Historic data from 

NCLIM daily
https://www.ncei.noaa.gov/products/land-based-station/nclimgrid-daily

and through two CMIP climate scenrios:

ssp126
Future scenario with low radiative forcing by the end of century. Following approximately 
RCP2.6 global forcing pathway but with new forcing based on SSP1. Concentration-driven. 
As a tier 2 option, this simulation should be extended to year 2300

1. ssp126
Future scenario with low radiative forcing by the end of century. Following approximately 
RCP2.6 global forcing pathway but with new forcing based on SSP1. Concentration-driven. 
As a tier 2 option, this simulation should be extended to year 2300.

2. ssp585
Future scenario with high radiative forcing by the end of century. 
Following approximately RCP8.5 global forcing pathway but with new forcing based on 
SSP5. Concentration-driven. As a tier 2 option, this simulation should be extended to year 2300.

From: https://wcrp-cmip.org/cmip-model-and-experiment-documentation/#models

Climate data was originally downloaded by Zhuonan, a student asssiant for Dr. Sihi, who processed the data from it's raw format into a set of csvs organized by specific parameter (e.g. min temp, max temp, precip) and at the county level, linked by GEOID. A script (1_create_county_climate_input_AD_v4_.R) placed in the Utilities folder was developed to read and place all county climate parameters into the same file as required by the model.

Soils data were similary processed by Zhuounan separated by parameter. A script (2_Create_soil_data_input_files_gNATSGO.R) was developed that placed all soils data into a county specific folder to be read by the models.

Model running

000_County_Run.R begins the modeling process and is the file that initiates the rest of the script. Initial pathnames, directories, and flags that modify how the model will be run are all contained here.

county_centroids_elevation_crops.csv located in the Data>county_start folder contains variables important for model start. The GEOID is the five digit code often used to combine and find county data across folders. There is also total crop acreage which is used to determine if the model should be run in the county. The threshold is 1 ha. If less than 1 ha the crop will not be run.

A few lines at the end of this script determine if model specific outputs are to be saved. After each model is run a set of csvs are created that are synthesized from model output tables. This makes this data superfluous. It is rather large as well so for instance when running on Derecho across all counties can require 30 TB of space. On the other hand saving the data is important for when debugging, so it's up to the user when to save.

The next script is 00_Main_County.R which creates model directories for the specific county and creates a climate for loop so that the model first runs the low change climate data, then runs the high change climate data.

Next the 0_Controller script is initiated.







